===== Sample #1 Input =====
8 2 
1 2 
2 3 
1 8 
8 7 
8 6 
4 6 
6 5 

===== Sample #1 Output =====
3 
2 1 1 3 3 3 3 2 
2 1 8 

