===== Sample #1 Input =====
5 4 2 3
1 3 2
1 4 2
4 1 2
5 2 4
===== Sample #1 Output =====
2
48
===== Sample #2 Input =====
10 8 2 8
1 7 4
3 1 4
5 1 3
2 3 5
1 6 3
5 5 8
3 6 6
4 4 7
===== Sample #2 Output =====
0
909
94680
===== Sample #3 Input =====
6 6 3 4
1 5 6
5 1 3
3 2 4
5 3 6
3 1 5
5 2 3
===== Sample #3 Output =====
965
42365
13048
