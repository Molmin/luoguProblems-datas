===== Sample #1 Input =====
4 3 2
0 3 4 1
0 2 3 3
2

===== Sample #1 Output =====
16
===== Sample #2 Input =====
8 9 6
0 1 1 1
0 2 2 9
0 3 3 2
0 4 4 6
0 5 5 0
0 6 6 8
0 7 7 1
0 8 8 7
2

===== Sample #2 Output =====
1
===== Sample #3 Input =====
10 15 14
2
0 6 6 439
0 3 8 1865
2
0 7 10 11371
2
1 1
2
2
1 3
2
0 5 8 7784
2
0 4 7 8497
2

===== Sample #3 Output =====
155712307
76042715
719747106
76042715
76042715
74890016
76042715
719747106
