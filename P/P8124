===== Sample #1 Input =====
6 6
1 2
2 3
3 4
4 5
5 2
5 6
1
4 3 2 5 4
===== Sample #1 Output =====
4
===== Sample #2 Input =====
6 6
1 2
2 3
3 4
4 5
5 2
5 6
1
4 4 5 2 3
===== Sample #2 Output =====
5
===== Sample #3 Input =====
11 13
1 2
2 3
3 4
4 2
3 5
5 6
6 7
7 5
6 8
8 9
9 10
10 8
9 11
3
3 4 2 3
3 7 6 5
3 10 8 9
===== Sample #3 Output =====
impossible
