===== Sample #1 Input =====
5 2 1
346 412
464 685
895 544
976 322
612 121
346 712 2
850 932 3

===== Sample #1 Output =====
4068

===== Sample #2 Input =====
5 2 2
346 412
464 685
895 544
976 322
612 121
233 749 798465123
698 985 151455772

===== Sample #2 Output =====
105133973
