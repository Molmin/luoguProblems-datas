===== Sample #1 Input =====
3 3
1 2 0
1 3 0
===== Sample #1 Output =====
12 4
===== Sample #2 Input =====
9 3
1 2 0
1 3 1
1 4 1
2 5 2
2 6 1
6 7 0
4 8 2
4 9 0
===== Sample #2 Output =====
648 12
