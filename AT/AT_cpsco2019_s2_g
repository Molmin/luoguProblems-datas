===== Sample #1 Input =====
3 3
1 2 0 1
2 3 0 5
3 1 1 x
3
4
5
6
===== Sample #1 Output =====
5
6
6
===== Sample #2 Input =====
9 15
1 3 0 954291757
2 3 1 x
2 4 1 x
1 5 0 138996221
2 5 0 353195922
3 5 1 x
4 5 0 913575467
1 6 0 824284691
1 7 1 x
2 7 1 x
1 8 0 131381221
6 8 0 208032501
7 8 0 973708325
5 9 1 x
6 9 0 298309896
5
215208399
554374432
47628333
810900084
87027328
===== Sample #2 Output =====
1554451938
2793039057
625183720
3562616013
861577690
