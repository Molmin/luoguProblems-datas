===== Sample #1 Input =====
3 1 3 1
0 1 2
1 2 1
===== Sample #1 Output =====
1
===== Sample #2 Input =====
5 4 3 2
1 2 3
0 1 2
1 2 1
2 3 5
3 4 5
===== Sample #2 Output =====
17
===== Sample #3 Input =====
4 2 4 2
0 1 2 3
0 1 1
2 3 1
===== Sample #3 Output =====
9
===== Sample #4 Input =====
9 9 4 6
1 3 6 8
1 4 4
6 7 1
4 5 3
3 6 2
4 7 5
7 8 1
1 5 3
1 0 2
4 8 1
===== Sample #4 Output =====
367
