===== Sample #1 Input =====
4
5 C
6 B
16 BAC
4 A

===== Sample #1 Output =====
15

===== Sample #2 Input =====
2
10 AB
15 BA

===== Sample #2 Output =====
-1

===== Sample #3 Input =====
5
10 A
9 BC
11 CA
4 A
5 B

===== Sample #3 Output =====
13

===== Sample #4 Input =====
6
100 A
355 BCA
150 BC
160 AC
180 B
190 CA

===== Sample #4 Output =====
250

===== Sample #5 Input =====
2
5 BA
11 CB

===== Sample #5 Output =====
16

