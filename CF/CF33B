===== Sample #1 Input =====
uayd
uxxd
3
a x 8
x y 13
d c 3

===== Sample #1 Output =====
21
uxyd

===== Sample #2 Input =====
a
b
3
a b 2
a b 3
b a 5

===== Sample #2 Output =====
2
b

===== Sample #3 Input =====
abc
ab
6
a b 4
a b 7
b a 8
c b 11
c a 3
a c 0

===== Sample #3 Output =====
-1

