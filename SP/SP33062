===== Sample #1 Input =====
10 12
4 2 3 5 6 47 10007 32768 59049 1
0 1 5
0 2 5
1 2
0 1 5
0 2 5
0 6 10
1 3
0 6 10
1 1
0 1 10
0 10 10
0 1 5
===== Sample #1 Output =====
60
30
15
15
772456932
411740567
342852967
1
60
