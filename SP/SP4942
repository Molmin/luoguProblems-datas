===== Sample #1 Input =====
3111989
13091989
77145199750673
0
===== Sample #1 Output =====
317^1 9817^1
17^2 89^1 509^1
328439^1 234884407^1
